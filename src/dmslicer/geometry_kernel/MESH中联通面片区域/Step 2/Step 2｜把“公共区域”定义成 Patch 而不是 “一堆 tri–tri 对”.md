好，进入 **Step 2：从 tri-level 升级到 patch-level（区域级）建模**。  
这一部就是你说的“可行性关键”：**不做这一步，你永远会被离散误差和不同网格划分折磨。**

---

# Step 2｜把“公共区域”定义成 **Patch** 而不是 “一堆 tri–tri 对”

你现在的目标可以写成一句话：

> 我不要单独的 (tri_i, tri_j) 对；  
> 我要的是：两个 object 之间“公共接触面”的 **连通区域 patch**（由一组面片组成，面积稳定、几何一致）。

### 为什么一定要 patch？

因为你已经承认了现实：

- 网格不对齐（顶点不共用）
    
- 有离散误差（不可能严格面–面相交）
    
- 会出现“近但不交”“局部错位”“缝隙/穿插”  
    👉 所以 **单个三角形对的判断永远不稳定**。  
    必须靠“区域一致性”来稳住。
    

---

## 2.1 Patch 的最小构成：三件事（你后面都要写进定义）

一个 patch 不是“随便聚类”，必须同时满足 3 个一致性：

1. **近共面一致性（coplanarity / normal coherence）**
    
    - patch 内的候选接触面片法线应该接近同一方向（允许一定角度误差）
        
2. **近距离一致性（gap coherence）**
    
    - patch 内两物体的“间隙”应整体小于阈值 ε（允许局部波动）
        
3. **连通性（connectivity）**
    
    - patch 必须在每个 object 的 mesh 上是连通的一片区域（不是散点）
        

> 这三条就是你抗“不同 triangulation”的核心武器。

---

## 2.2 你最终要输出的“公共区域”到底是什么？

这里我建议你用一个非常清晰的输出形式（可写进论文）：

> 输出为一组 **Patch 对**：  
> $$
> \mathcal{P} = {(P^A_k,, P^B_k)}_{k=1..K}  
> $$
> 其中

- $P^A_k$ 是 Object A 上的一组三角面片索引（连通子图）
    
- $P^B_k$ 是 Object B 上对应的三角面片索引
    
- 两者共同近似同一块连续“公共接触面”
    

这比“返回一堆 tri–tri pairs”高级一个层级，而且很容易做统计与可视化。

---

## 2.3 Patch 的生成流程（概念版，不写代码）

你可以把流程分成 4 层，这样写论文也清楚：

### (i) 候选生成（candidate pairs）

- BVH 找到可能接近的 tri–tri
    
- 但这里 **只作为候选**，不做最终结论
    

### (ii) 关系打分（pair scoring）

对每个候选 (tA, tB) 计算：

- 法线夹角 `angle(nA, nB)`
    
- 平面距离 / 间隙 `gap`
    
- 投影重叠面积 `area2D`（允许近似）  
    得到一个 “可信度” 分数
    

### (iii) 区域生长（patch growing）

- 从高可信 pair 作为种子
    
- 在 A 的邻接三角形（共享边）扩展，同时在 B 上扩展
    
- 扩展条件就是上面 3 个一致性（法线、gap、连通）
    

### (iv) patch 级验证（patch validation）

- patch 面积（在 A 上或 B 上）要 > 面积阈值
    
- patch 的平均 gap、法线方差要在范围内
    
- 过滤掉“边擦边”“点接触”的伪 patch
    

---

## 2.4 这一步和你之前的 bug（假接触爆炸）有什么关系？

你之前爆炸的核心是：  
“只要 2D overlap 就当接触”。

Patch 化以后，你可以自然引入一个**非常强的过滤**：

> **如果它真是公共接触面，它应该形成一片连通的面片区域。**  
> 若只是误判/数值噪声，往往只能形成零散 pair，长不成 patch，自动被剔除。

这就是把“几何不稳定”转成“统计稳定”。

---

# 现在轮到你（只问一个问题，决定 patch 的形态）

为了让 Step 2 真正落地，我只问你一个关键问题：

> 你的“公共区域”更像下面哪一种？  
> **A)** “两物体表面之间的一层薄的近接触带”（允许小 gap）  
> **B)** “真正的几何重合面”（更严格，gap 约等于 0）

你只选 A 或 B。选完我就把 Step 2 的定义里：

- ε（gap tolerance）怎么写
    
- patch validation 用哪些指标
    
- 以及如何在论文里把它说得严谨  
    全部固定下来。