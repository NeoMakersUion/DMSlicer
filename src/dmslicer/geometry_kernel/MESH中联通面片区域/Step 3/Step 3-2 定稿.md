
# **Step 2｜Patch-Level Support with Aggregated Coverage (Revised & Final)**

## 2.1 背景与问题：为什么“单一 SR 判定”是不可靠的？

在独立三角网格表示下，公共接触区域在离散层面通常呈现为**碎片化重叠**，而非一一对应的面片重合。  
特别是在以下典型场景中，**基于单对 patch 或三角形的重叠覆盖度（SR）判定会系统性失效**：

1. **多对一覆盖（many-to-one coverage）**
    
    - 一个较大的三角面片（粗网格）被多个较小面片（细网格）分别覆盖；
    - 任意单个小面片与大面片的重叠比例可能均低于固定阈值（如 0.6）；
    - 但从整体区域角度看，大面片被完整覆盖。
2. **碎片化覆盖（fragmented overlap）**
    
    - 连续公共接触面在离散表示中被拆分为多个局部片段；
    - 每个片段单独评估时支持度不足，但聚合后形成稳定公共区域。
3. **独立网格分辨率不一致**
    
    - 不同对象采用不同网格密度或局部加密策略；
    - 导致“公平的一对一面积比例比较”在离散层面不成立。

在上述情况下，**使用固定阈值对单个 SR 进行判定会产生系统性漏检**，即真实公共区域被错误排除。

---

## 2.2 原始 Support Ratio（SR）的局限性

在局部参考平面 $\Pi$ 上，对 patch 对 $(P^A, P^B)$ 的投影区域 $R_A, R_B$，  
原始支持度定义为：

$$ \mathrm{SR}(P) = \frac{\mathrm{Area}(R_A \cap R_B)} {\min\big(\mathrm{Area}(R_A),\ \mathrm{Area}(R_B)\big)} $$

该定义在以下情况下是合理的：

- patch 规模相近；
- 重叠区域连续；
- 网格分辨率相对一致。

但在碎片化覆盖场景中，**原始 SR 作为单一判定标准是不充分的**，因为：

- SR 是局部比例量，无法反映“多个局部片段的整体覆盖贡献”；
- 固定阈值会不公平地惩罚被拆分的较小 patch。

---

## 2.3 关键思想：从“单对判定”转向“聚合覆盖判定”

为解决上述问题，本方法不再将 SR 用作**单对 patch 的最终判定标准**，而是引入：

> **基于聚合区域的支持度评估（Aggregated Support）**

核心思想是：

- 允许单个局部片段的 SR 较低；
- 只要这些片段在拓扑上相邻、几何上一致；
- 它们的**聚合区域**应被整体评估其覆盖支持度。

这与连续几何中的直觉一致：  
**公共接触面是一个区域概念，而非单个局部片段的性质。**

---

## 2.4 聚合支持度（Aggregated Support Ratio, SR_agg）

在 patch 聚合完成后（聚合规则将在 Step 3 中定义），  
对聚合后的区域 $(\tilde{P}^A, \tilde{P}^B)$ 计算其投影区域：

- $\tilde{R}_A = \mathrm{proj}_\Pi(\tilde{P}^A)$
- $\tilde{R}_B = \mathrm{proj}_\Pi(\tilde{P}^B)$

定义 **聚合支持度**：

$$ \mathrm{SR}_{\text{agg}} = \frac{\mathrm{Area}(\tilde{R}_A \cap \tilde{R}_B)} {\min\big(\mathrm{Area}(\tilde{R}_A),\ \mathrm{Area}(\tilde{R}_B)\big)} $$

该定义具有以下特性：

- 对多对一、碎片化覆盖鲁棒；
- 与网格分辨率无关；
- 直接反映“较小一侧是否被整体覆盖”。

---

## 2.5 两阶段支持度门控策略（Two-Stage Support Gating）

基于上述思想，本方法采用**两阶段支持度判定**，而非单一固定阈值。

### Stage 1：Seed 支持度（宽松门控）

- 对局部候选 patch 使用较低阈值： $$ \mathrm{SR} > \tau_{\text{seed}} $$
    
- 目的：
    
    - 防止碎片化区域在早期被错误剔除；
    - 为后续 patch 聚合保留潜在公共区域。

### Stage 2：Final 支持度（严格判定）

- 对聚合后的 patch 使用较高阈值： $$ \mathrm{SR}_{\text{agg}} > \tau_{\text{final}}, \quad \tau_{\text{final}} > \tau_{\text{seed}} $$
    
- 目的：
    
    - 确保最终输出的公共区域在整体尺度上具有充分面积支持；
    - 剔除仅由零散误配拼接而成的伪区域。

---

## 2.6 面积支持下限（Area Support Lower Bound）

为避免极小区域在偶然情况下获得较高 SR 或 SR_agg，引入面积下限约束：

$$ \min\big(\mathrm{Area}(\tilde{R}_A),\ \mathrm{Area}(\tilde{R}_B)\big) > \eta \cdot h^2 $$

其中：

- $h$ 为局部网格特征长度尺度；
- $\eta$ 为无量纲常数。

该约束确保 SR_agg 的判定建立在具有实际几何意义的区域基础之上。

---

## 2.7 Step 2 的作用边界（再次明确）

> Step 2 的目标是**评估区域级的几何支持度是否可信**，  
> 而非决定 patch 的最终拓扑合并方式。  
> Patch 的生成与聚合规则将在 Step 3 中定义。

---

# ✅ 现在这个 Step 2 和之前相比，**多了三件关键的东西**

1. **明确指出“原始 SR 为什么不够”**（不是拍脑袋换定义）
2. **清楚区分 SR（局部） vs SR_agg（聚合）**
3. **给出两阶段门控的逻辑必然性，而非经验技巧**

---

## 现在只需要你最后确认一件事

> 这个版本的 Step 2，是否已经**清楚解释了：  
> 为什么要从“单一 SR 判定”升级到“聚合支持度 + 两阶段门控”？**

你只回答：**是 / 还需要加强某一段（你可以点名段落）**。